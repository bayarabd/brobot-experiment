"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6433],{3905:function(e,t,n){n.d(t,{Zo:function(){return h},kt:function(){return g}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),d=u(n),g=a,m=d["".concat(l,".").concat(g)]||d[g]||c[g]||o;return n?i.createElement(m,r(r({ref:t},h),{},{components:n})):i.createElement(m,r({ref:t},h))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<o;u++)r[u]=n[u];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6529:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return u},toc:function(){return h},default:function(){return d}});var i=n(7462),a=n(3366),o=(n(7294),n(3905)),r=["components"],s={sidebar_position:4},l="Image Analysis",u={unversionedId:"API/state structure/image-analysis",id:"API/state structure/image-analysis",isDocsHomePage:!1,title:"Image Analysis",description:"How carefully you select your images and define your regions",source:"@site/docs/API/state structure/image-analysis.md",sourceDirName:"API/state structure",slug:"/API/state structure/image-analysis",permalink:"/brobot/docs/API/state structure/image-analysis",editUrl:"https://jspinak.github.io/brobot/docs/API/state structure/image-analysis.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Attributes",permalink:"/brobot/docs/API/state structure/attributes"},next:{title:"Transitions",permalink:"/brobot/docs/API/state structure/transitions"}},h=[{value:"Common issues with images and regions",id:"common-issues-with-images-and-regions",children:[],level:2},{value:"Brobot&#39;s image analysis",id:"brobots-image-analysis",children:[],level:2},{value:"Using the image analysis",id:"using-the-image-analysis",children:[{value:"Multiple matches found",id:"multiple-matches-found",children:[],level:3},{value:"Image not found",id:"image-not-found",children:[],level:3}],level:2},{value:"Defining regions",id:"defining-regions",children:[{value:"Defining regions without static images",id:"defining-regions-without-static-images",children:[],level:3},{value:"Defining regions with non-static images",id:"defining-regions-with-non-static-images",children:[],level:3},{value:"Defining the region of a State",id:"defining-the-region-of-a-state",children:[],level:3}],level:2}],c={toc:h};function d(e){var t=e.components,s=(0,a.Z)(e,r);return(0,o.kt)("wrapper",(0,i.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"image-analysis"},"Image Analysis"),(0,o.kt)("p",null,"How carefully you select your images and define your regions\nwill be key to the robustness and\neffectiveness of your automation application. Identifying\nthe optimal images to use early on will save you lots of time and frustration.\nIdeally, you should analyse and optimize your images before writing any code.\nBrobot has functionality that is dedicated to pre-app image analysis. It works together\nwith the StateStructure builder to give you an idea of which images may cause\nproblems and what you may want to change."),(0,o.kt)("h2",{id:"common-issues-with-images-and-regions"},"Common issues with images and regions"),(0,o.kt)("p",null,"Adjusting the minimum similarity of images is a common technique for situations\nwhere an image may vary slightly but still needs to be found with high certainty.\nMin similarity is also adjusted in the opposite scenario, where similar images\nexist on the screen, and it's important to find only the one we want. Both scenarios\nare a consequence of trial-and-error programming, something that we want to avoid when\ndeveloping automation software. Ideally, we will choose images that don't require\nadjusting the min similarity at some point down the line. "),(0,o.kt)("p",null,"Sometimes we can't choose an image that is unique. For example, we have a\n'close' button like the 'X' at the top right of a window that is the same for\nall windows in the environment we are controlling. In this case, it is best to\nset the SearchRegion, when possible, to look for only the window we want to close.\nIn addition, the 'close' image should be set to ",(0,o.kt)("inlineCode",{parentName:"p"},"shared")," so that it is not\nused to find a State in the case that Brobot gets lost.   "),(0,o.kt)("p",null,"Defining SearchRegions can be difficult during execution. If we are working with\nimages that don't always appear in the same location, we will want to identify the\npotential area where they could appear and limit our search to this area. Even if\nwe know in advance where this area is, identifying the exact coordinates on the\nscreen is not always precise or easy to do. In addition, finding regions during\nexecution is especially difficult when the regions contain few or no static\nimages. "),(0,o.kt)("h2",{id:"brobots-image-analysis"},"Brobot's image analysis"),(0,o.kt)("p",null,"During the process that builds the StateStructure, an analysis of each screenshot\nis output to the console, and contains information on GROUP_DEFINE operations as\nwell as images and their matches under the following conditions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"at least one match is found"),(0,o.kt)("li",{parentName:"ul"},"the image has an active attribute on this screenshot whose operation fails  ")),(0,o.kt)("h2",{id:"using-the-image-analysis"},"Using the image analysis"),(0,o.kt)("p",null,"Errors in the attribute operations give us valuable information about our images."),(0,o.kt)("h3",{id:"multiple-matches-found"},"Multiple matches found"),(0,o.kt)("p",null,"If an image should only be found once but is found multiple times in a screenshot,\nwe know that this is either a shared image or that it should be changed or replaced.\nShared images are sometimes necessary, but should include a defined SearchRegion\nwhen possible. When an image does not have an active MULTIPLE_MATCHES attribute and\nappears multiple times, it is initialized with the field ",(0,o.kt)("inlineCode",{parentName:"p"},".isShared(true)"),". Images\nthat are meant to be unique and appear once but are found multiple times are problems.\nYou should check out the screenshot and try to find the matches from the coordinates\ngiven in the image analysis. If changing or replacing the image is not possible, think\nabout either defining the image's SearchArea\nto get rid of the other matches or using a different strategy to achieve you goal.  "),(0,o.kt)("h3",{id:"image-not-found"},"Image not found"),(0,o.kt)("p",null,"Not finding an image at all when it should be found is a sign of a poorly chosen image,\nor of a non-static image that is not well suited for traditional image recognition.\nIf there is no way to use an image that is more static, you may want to change your\nstrategy for this specific process. There are almost always multiple ways to achieve\nthings in process automation.  "),(0,o.kt)("p",null,"Failure to define a region is usually caused by not finding an image. Finding\ntoo many matches or finding an image in the wrong place can result in an\nincorrectly defined region. The coordinates and size of defined regions are printed\nto the console along with information about images and matches.  "),(0,o.kt)("h2",{id:"defining-regions"},"Defining regions"),(0,o.kt)("p",null,"Having well-defined SearchRegions will make your process flow more robust,\nand many regions can and should be defined before execution by the\nStateStructure build process. "),(0,o.kt)("h3",{id:"defining-regions-without-static-images"},"Defining regions without static images"),(0,o.kt)("p",null,"These regions are very difficult to capture during a real run,\nbut can be easily captured when using screenshots. For example, in order to capture\nthis region of a minimap during a real run ",(0,o.kt)("img",{alt:"minimap",src:n(9807).Z}),", I would try to find\nthe one static image, which is the small circle in the top left with 2D written on it,\nand then adjust the region around this match by guessing and readjusting my guesses.\nIf there were no static images, i would try to find static images that\nappear outside the minimap and adjust the region. "),(0,o.kt)("p",null,"The attribute to use in this situation is REGION. When the filename of an image\ncontains the String '_r', it will search for the image and write a StateRegion\nwith a pre-defined SearchRegion to the corresponding State. In order not to\nreceive error messages in the image analysis for every other screenshot, make\nsure to specify the screenshot to use after the '_r' (i.e. '_r28').  "),(0,o.kt)("h3",{id:"defining-regions-with-non-static-images"},"Defining regions with non-static images"),(0,o.kt)("p",null,"These are regions that have a variable number of images, each with\nvariable locations, and we want to find the region that includes all of them.\nThere are two ways to do this. The first is to take an image of the area you\nthink you need and give\nit the TRANSFER attribute for this screenshot. The TRANSFER attribute will\ntransfer the match to the SearchRegions of all images in the State.",(0,o.kt)("br",{parentName:"p"}),"\n","Another option is to use GROUP_DEFINE, which will set the SearchRegions of each\nimage in the group to be the region that combines all of their matches."),(0,o.kt)("h3",{id:"defining-the-region-of-a-state"},"Defining the region of a State"),(0,o.kt)("p",null,"Many States have one area of the screen where all the State objects can be found.\nIt is a good idea to set this region to be the SearchRegion for all images in the\nState. Doing this with the StateStructure builder is easy. The attributes to use\nare TRANSFER or GROUP_DEFINE."))}d.isMDXComponent=!0},9807:function(e,t,n){t.Z=n.p+"assets/images/minimap-8e72060252b482e2caa4b937c0975e21.png"}}]);