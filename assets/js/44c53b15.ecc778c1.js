"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6433],{3905:(e,t,i)=>{i.d(t,{Zo:()=>h,kt:()=>g});var n=i(7294);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):r(r({},t),e)),i},h=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var i=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),d=u(i),g=a,m=d["".concat(l,".").concat(g)]||d[g]||c[g]||o;return i?n.createElement(m,r(r({ref:t},h),{},{components:i})):n.createElement(m,r({ref:t},h))}));function g(e,t){var i=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=i.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<o;u++)r[u]=i[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,i)}d.displayName="MDXCreateElement"},6529:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>u});var n=i(7462),a=(i(7294),i(3905));const o={sidebar_position:4},r="Image Analysis",s={unversionedId:"API/state structure/image-analysis",id:"API/state structure/image-analysis",title:"Image Analysis",description:"How carefully you select your images and define your regions",source:"@site/docs/API/state structure/image-analysis.md",sourceDirName:"API/state structure",slug:"/API/state structure/image-analysis",permalink:"/brobot/docs/API/state structure/image-analysis",draft:!1,editUrl:"https://jspinak.github.io/brobot/docs/API/state structure/image-analysis.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Attributes",permalink:"/brobot/docs/API/state structure/attributes"},next:{title:"Transitions",permalink:"/brobot/docs/API/state structure/transitions"}},l={},u=[{value:"Common issues with images and regions",id:"common-issues-with-images-and-regions",level:2},{value:"Brobot&#39;s image analysis",id:"brobots-image-analysis",level:2},{value:"Using the image analysis",id:"using-the-image-analysis",level:2},{value:"Multiple matches found",id:"multiple-matches-found",level:3},{value:"Image not found",id:"image-not-found",level:3},{value:"Defining regions",id:"defining-regions",level:2},{value:"Defining regions without static images",id:"defining-regions-without-static-images",level:3},{value:"Defining regions with variable-location images",id:"defining-regions-with-variable-location-images",level:3},{value:"Defining the region of a State",id:"defining-the-region-of-a-state",level:3}],h={toc:u};function c(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,n.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"image-analysis"},"Image Analysis"),(0,a.kt)("p",null,"How carefully you select your images and define your regions\nwill be key to the robustness and\neffectiveness of your automation application. Identifying\nthe optimal images to use early on will save you lots of time and frustration.\nIdeally, you should analyze and optimize your images before writing any code.\nBrobot has functionality that is dedicated to pre-code image analysis. It works together\nwith the State Structure builder to give you an idea of which images may cause\nproblems and what you may want to change."),(0,a.kt)("h2",{id:"common-issues-with-images-and-regions"},"Common issues with images and regions"),(0,a.kt)("p",null,"Adjusting the minimum similarity of images is a common technique for situations\nwhere an image is not recognized as we expect. The image may vary slightly but still\nneeds to be found with high certainty, in which case the minimum similarity would\nbe lowered. Minimum similarity is also adjusted upwards, in scenarios where similar images\nexist on the screen, and it's important to find only the one we want. Both scenarios\ninvolve trial-and-error programming, a technique that we want to avoid when\ndeveloping automation software. Ideally, we will choose images that don't require\nadjusting the minimum similarity at some point down the line. "),(0,a.kt)("p",null,"Sometimes we can't choose an image that is unique. For example, we have a\nclose button like the 'X' at the top right of a window that is the same for\nall windows in the environment. In this case, it is best to\nset the SearchRegion to look for only the button we want to press.",(0,a.kt)("br",{parentName:"p"}),"\n","In addition, the close image should be defined as ",(0,a.kt)("inlineCode",{parentName:"p"},"shared")," so that it is not\nused to find a State in the case that Brobot gets lost.   "),(0,a.kt)("p",null,"Defining regions can be difficult during execution. If we are working with\nimages that don't always appear in the same location, we may want to identify the\narea where they could appear and limit our search to this area. Even if\nwe know in advance where this area is, identifying the exact coordinates on the\nscreen is not always easy to do and the results can be imprecise.\nFinding regions during\nexecution is especially difficult when the regions contain few or no static\nimages.  "),(0,a.kt)("h2",{id:"brobots-image-analysis"},"Brobot's image analysis"),(0,a.kt)("p",null,"During the process that builds the StateStructure, an analysis of each screenshot\nis output to the console. This analysis contains information on GROUP_DEFINE and\nTRANSFER operations as well as images and their matches under the following conditions:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"at least one match is found"),(0,a.kt)("li",{parentName:"ul"},"an active attribute fails")),(0,a.kt)("h2",{id:"using-the-image-analysis"},"Using the image analysis"),(0,a.kt)("p",null,"Errors in the attribute operations give us valuable information about our images."),(0,a.kt)("h3",{id:"multiple-matches-found"},"Multiple matches found"),(0,a.kt)("p",null,"If an image should be found only once but is found multiple times in a screenshot,\nwe know that this is either a shared image or that it should be changed or replaced.\nShared images are sometimes necessary, but should include a defined SearchRegion\nwhen possible. When an image does not have an active MULTIPLE_MATCHES attribute and\nappears multiple times, it is initialized with the field ",(0,a.kt)("inlineCode",{parentName:"p"},".isShared(true)"),". Images\nthat are meant to be unique and appear once but are found multiple times are problems.\nYou should check out the screenshot and try to find the matches from the coordinates\ngiven in the image analysis. If changing or replacing the image is not possible, think\nabout either defining the image's SearchRegion\nto exclude the other matches or using a different strategy to achieve your goal.  "),(0,a.kt)("h3",{id:"image-not-found"},"Image not found"),(0,a.kt)("p",null,"Not finding an image at all when it should be found is a sign of a poorly chosen image,\nor of a non-static image that is not well suited for traditional image recognition.\nIf there is no way to use an image that is more static, you may want to change your\nstrategy for this specific process. There are almost always multiple ways to achieve\nthings in process automation.  "),(0,a.kt)("p",null,"Failure to define a region is usually caused by not finding an image. Finding\ntoo many matches or finding an image in the wrong place can result in an\nincorrectly defined region. The coordinates and size of defined regions are printed\nto the console along with information about images and matches.  "),(0,a.kt)("h2",{id:"defining-regions"},"Defining regions"),(0,a.kt)("p",null,"Having well-defined SearchRegions will make your process flow more robust,\nand many regions can and should be defined before execution by the\nState Structure build process.  "),(0,a.kt)("h3",{id:"defining-regions-without-static-images"},"Defining regions without static images"),(0,a.kt)("p",null,"Static images are ones that do not change their appearance. Fixed-location images are\nones that do not change their location. Finding regions without static, fixed-location\nimages is very difficult during a real run, but can be easily captured when using\nscreenshots. Take, for example, the minimap portrayed here after this paragraph.\nTo find the region of the minimap during a real run, I would try to find\nthe one static and fixed-location image, the small circle in the top left with\n2D written on it,\nand then adjust the region around this match by guessing and readjusting my guesses\nthrough trial and error.\nIf there were no static, fixed-location images, I would try to find\nsuch images outside the minimap and adjust the region accordingly.   "),(0,a.kt)("img",{src:"https://jspinak.github.io/brobot/img/minimap.png",alt:"minimap",width:"200"}),(0,a.kt)("p",null,"The attribute to use in this situation is REGION. When the filename of an image\ncontains the String ",(0,a.kt)("inlineCode",{parentName:"p"},"_r"),", it will search for the image and write a StateRegion\nwith a pre-defined SearchRegion to the corresponding State. In order not to\nreceive error messages in the image analysis for every other screenshot, make\nsure to specify the screenshot to use after the ",(0,a.kt)("inlineCode",{parentName:"p"},"_r")," (i.e. ",(0,a.kt)("inlineCode",{parentName:"p"},"_r28"),").  "),(0,a.kt)("h3",{id:"defining-regions-with-variable-location-images"},"Defining regions with variable-location images"),(0,a.kt)("p",null,"There are regions that have a variable number of images, each with\nvariable locations. We may want to find the region that includes all of them,\nin order to make our searches faster and more effective.\nThere are two ways to do this. The first is to take an image of the area you\nthink you need and give\nit the TRANSFER attribute for this screenshot. The TRANSFER attribute will\ntransfer the match to the SearchRegions of all images in the State.",(0,a.kt)("br",{parentName:"p"}),"\n","Another option is to use GROUP_DEFINE, which will set the SearchRegions of each\nimage in the group to be the union of their matches."),(0,a.kt)("h3",{id:"defining-the-region-of-a-state"},"Defining the region of a State"),(0,a.kt)("p",null,"Many States have one area of the screen where all the State objects can be found.\nIt is a good idea to set this region to be the SearchRegion for all images in the\nState. Doing this with the StateStructure builder is easy. The attributes to use\nare TRANSFER or GROUP_DEFINE."))}c.isMDXComponent=!0}}]);